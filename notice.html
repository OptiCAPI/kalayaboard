<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>অনলাইন নোটিশ বোর্ড ২০২৬ | কালাইয়া বোর্ড সপ্রাবি</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;600;700&display=swap');
        body { font-family: 'Hind Siliguri', sans-serif; background-color: #f0f4f8; }
        
        .navbar { background: #006A4E; }
        .notice-header { background: linear-gradient(135deg, #006A4E 0%, #004d39 100%); color: white; padding: 50px 0; border-bottom: 6px solid #FFB800; }

        /* Notice Card */
        .notice-card {
            background: #fff; border-radius: 20px; padding: 20px;
            margin-bottom: 15px; border-left: 6px solid #006A4E;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            display: flex; align-items: center; justify-content: space-between;
        }

        .notice-date { background: #e8f5e9; color: #006A4E; padding: 8px; border-radius: 12px; min-width: 90px; text-align: center; font-weight: 700; line-height: 1.2; }
        .notice-content { flex-grow: 1; padding: 0 20px; }
        .urgent-badge { background: #ff5252; color: white; padding: 2px 8px; border-radius: 5px; font-size: 11px; font-weight: 600; margin-bottom: 5px; display: inline-block; }

        .btn-view { background: #e8f5e9; color: #006A4E; border: 1px solid #006A4E; border-radius: 50px; padding: 6px 15px; font-size: 14px; transition: 0.3s; margin-right: 5px; }
        .btn-view:hover { background: #006A4E; color: #fff; }

        .btn-download { background: #FFB800; color: #000; border-radius: 50px; padding: 6px 15px; font-size: 14px; font-weight: 700; border: none; }

        /* Modal Settings */
        .modal-content { border-radius: 25px; border: none; }
        .modal-header { background: #006A4E; color: white; border-radius: 25px 25px 0 0; }
        #pdf-viewer { width: 100%; height: 500px; border: none; border-radius: 10px; }
    </style>
</head>
<body>

<nav class="navbar navbar-dark shadow-sm">
    <div class="container">
        <a class="navbar-brand fw-bold" href="index.html"><img src="images/govt.png" width="30" class="me-2"> কালাইয়া বোর্ড সপ্রাবি</a>
    </div>
</nav>

<header class="notice-header text-center">
    <div class="container">
        <h2 class="fw-bold"><i class="fas fa-bullhorn me-2 text-warning"></i> অনলাইন নোটিশ বোর্ড - ২০২৬</h2>
        <p class="opacity-75">গুগল শিট থেকে অটোমেটিক আপডেটকৃত</p>
    </div>
</header>

<div class="container my-5">
    <div id="notice-list" class="col-lg-10 mx-auto">
        <div class="text-center py-5">
            <div class="spinner-border text-success" role="status"></div>
            <p class="mt-2">সর্বশেষ নোটিশ লোড হচ্ছে...</p>
        </div>
    </div>
</div>

<div class="modal fade" id="viewModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title fw-bold" id="modalTitle">নোটিশ প্রিভিউ</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <iframe id="pdf-viewer" src=""></iframe>
            </div>
            <div class="modal-footer">
                <a href="" id="modalDownloadLink" class="btn btn-warning rounded-pill px-4 fw-bold" download>ডাউনলোড করুন</a>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // আপনার পাবলিশ করা Google Sheets CSV লিঙ্কটি এখানে বসান
    const csv_url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTWc0HbimA9ddlA7yP3KG4ahQosskjgdihVtL3EJIebhKdiF0_N10dkOEp_9Q66T7cX1JqHZXiwbwbN/pub?gid=0&single=true&output=csv"; 

    async function loadNotices() {
        try {
            const response = await fetch(csv_url);
            const data = await response.text();
            const rows = data.split('\n').slice(1); 
            let html = '';

            rows.forEach(row => {
                const col = row.split(','); // কলামগুলো: Date, Title, Link, Urgent
                if (col.length >= 3) {
                    const isUrgent = col[3] && col[3].trim() !== "" ? `<span class="urgent-badge">জরুরি</span>` : "";
                    
                    html += `
                    <div class="notice-card">
                        <div class="notice-date">${col[0]}</div>
                        <div class="notice-content">
                            ${isUrgent}
                            <h6 class="notice-title mb-0">${col[1]}</h6>
                        </div>
                        <div class="d-flex">
                            <button class="btn-view" onclick="openNotice('${col[1]}', '${col[2].trim()}')">
                                <i class="fas fa-eye"></i> দেখুন
                            </button>
                            <a href="${col[2].trim()}" class="btn-download d-none d-md-inline-block" download>
                                <i class="fas fa-download"></i>
                            </a>
                        </div>
                    </div>`;
                }
            });
            document.getElementById('notice-list').innerHTML = html || "<p class='text-center'>কোনো নোটিশ পাওয়া যায়নি।</p>";
        } catch (e) {
            document.getElementById('notice-list').innerHTML = "<p class='text-center text-danger'>নোটিশ লোড করতে ব্যর্থ হয়েছে।</p>";
        }
    }

    function openNotice(title, link) {
        document.getElementById('modalTitle').innerText = title;
        // গুগল ড্রাইভ লিঙ্কের জন্য সরাসরি প্রিভিউ মোড সেট করা
        let previewLink = link.replace('/view?usp=sharing', '/preview');
        document.getElementById('pdf-viewer').src = previewLink;
        document.getElementById('modalDownloadLink').href = link;
        
        var myModal = new Bootstrap.Modal(document.getElementById('viewModal'));
        myModal.show();
    }

    loadNotices();
</script>

</body>
</html>
