<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶è‡¶ï‡¶æ‡¶°‡ßá‡¶Æ‡¶ø‡¶ï ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü | ‡ßß‡ß®‡¶®‡¶Ç ‡¶ï‡¶æ‡¶≤‡¶æ‡¶á‡¶Ø‡¶º‡¶æ ‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶∏‡¶™‡ßç‡¶∞‡¶æ‡¶¨‡¶ø</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;700&family=Atma:wght@500;700&display=swap');
        
        :root { 
            --primary-green: #006A4E; 
            --kids-orange: #FF8C42;
            --kids-blue: #48CAE4;
        }
    
        body { 
            background: #f0f9ff url('https://www.transparenttextures.com/patterns/cubes.png');
            font-family: 'Hind Siliguri', sans-serif; 
        }

        /* --- ‡¶∂‡¶ø‡¶∂‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ UI (‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶æ‡¶≤ ‡¶Ö‡¶Ç‡¶∂‡ßá) --- */
        .kids-title {
            font-family: 'Atma', cursive;
            color: var(--primary-green);
            text-shadow: 1px 1px 0px #fff;
        }

        .sticky-sub-wrapper {
            position: fixed;
            top: 15px;
            left: 0;
            width: 100%;
            z-index: 2000;
        }

        .floating-bar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 100px;
            padding: 8px 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border: 3px solid var(--kids-blue);
            margin: 0 auto;
            max-width: 450px;
            display: flex;
            justify-content: center;
        }

        .sub-menu-list { list-style: none; display: flex; gap: 12px; margin: 0; padding: 0; }
        .sub-menu-list a {
            text-decoration: none; color: #333; font-weight: 700; font-size: 14px;
            padding: 8px 16px; border-radius: 50px; display: flex; align-items: center; gap: 6px;
            transition: 0.3s;
        }
        .sub-menu-list a:hover { background: var(--kids-blue); color: #fff; }

        .search-form-card {
            background: white;
            border-radius: 30px !important;
            border: 5px solid var(--kids-orange) !important;
            box-shadow: 0 10px 0px var(--kids-orange);
        }

        /* --- ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡¶∂‡¶ø‡¶ü ‡¶ï‡¶æ‡¶∞‡ßç‡¶° (‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶∞‡¶æ‡¶ñ‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá) --- */
        .premium-title { font-family: 'Kalpana', 'Constantia', serif; font-weight: bold; }
        .student-name { font-family: 'Kalpana', 'Constantia', serif; font-style: italic; font-size: 24px; color: #000; }
        .table-font { font-family: 'Hind Siliguri', sans-serif; font-size: 15px; }

        #resultArea {
            width: 210mm; 
            height: 297mm; 
            background: white;
            margin: 30px auto; 
            padding: 10mm; 
            box-sizing: border-box;
            border: 12px double var(--primary-green); 
            position: relative; 
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 20px rgba(0,0,0,0.15);
            overflow: hidden;
        }

        .watermark-img {
            position: absolute; top: 52%; left: 50%; transform: translate(-50%, -50%);
            width: 460px; opacity: 0.05; z-index: 999; pointer-events: none;
        }

        #printTimestamp {
            display: none; position: absolute; bottom: 3mm; right: 80mm;
            font-size: 10px; color: #555; z-index: 1000;
        }
    
        .main-content { position: relative; z-index: 10; flex-grow: 1; }
        .table-main { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .table-main th, .table-main td { border: 1.5px solid #000 !important; vertical-align: middle; padding: 6px !important; }

        .footer-signatures {
            position: absolute; bottom: 20mm; left: 15mm; right: 15mm;
            display: flex; justify-content: space-between; z-index: 1000;
        }

        @media print {
            body { background: none; padding: 0; margin: 0; }
            .no-print, .navbar, .search-form-card, .premium-archive-section, .sticky-sub-wrapper { display: none !important; }
            #printTimestamp { display: block; }
            #resultArea { 
                margin: 0 !important; border: 12px double var(--primary-green) !important;
                box-shadow: none; page-break-after: always;
            }
            @page { size: A4; margin: 0; }
        }

        .premium-archive-btn {
            background: linear-gradient(45deg, #006A4E, #00a379);
            color: white; border: none; padding: 12px 30px;
            border-radius: 50px; font-weight: bold; transition: 0.3s;
            animation: pulse-animation 2s infinite;
        }
        @keyframes pulse-animation { 0% {transform:scale(1)} 50% {transform:scale(1.05)} 100% {transform:scale(1)} }
    </style>
</head>
<body>

<div class="sticky-sub-wrapper no-print">
    <div class="container d-flex justify-content-center">
        <div class="floating-bar">
            <ul class="sub-menu-list">
                <li><a href="index.html"><i class="fas fa-home"></i> <span>‡¶π‡ßã‡¶Æ</span></a></li>
                <li><a href="results.html" class="bg-success text-white"><i class="fas fa-poll"></i> <span>‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü</span></a></li>
                <li><a href="notice.html"><i class="fas fa-bullhorn"></i> <span>‡¶®‡ßã‡¶ü‡¶ø‡¶∂</span></a></li>
            </ul>
        </div>
    </div>
</div>

<div class="container no-print" style="margin-top: 100px;">
    <div class="card p-4 shadow search-form-card mx-auto mb-4" style="max-width: 550px;">
        <h2 class="text-center fw-bold kids-title mb-4" id="searchTitle">
            ‚ú® ‡¶ö‡¶≤‡ßã ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶ø!
        </h2>
        <div class="row g-3">
            <div class="col-6">
                <label class="small fw-bold">üéí ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</label>
                <select class="form-select rounded-pill border-2" id="classSelect">
                    <option value="5">‡ß´‡¶Æ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</option>
                    <option value="4">‡ß™‡¶∞‡ßç‡¶• ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</option>
                    <option value="3">‡ß©‡¶Ø‡¶º ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</option>
                </select>
            </div>
            <div class="col-6">
                <label class="small fw-bold">üìù ‡¶ï‡ßã‡¶® ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ?</label>
                <select class="form-select rounded-pill border-2" id="termSelect">
                    <option value="term1">‡ßß‡¶Æ ‡¶™‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø‡¶ï</option>
                    <option value="term2" selected>‡ß®‡¶Ø‡¶º ‡¶™‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø‡¶ï</option>
                    <option value="term3">‡ß©‡¶Ø‡¶º ‡¶™‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø‡¶ï</option>
                </select>
            </div>
            <div class="col-12 mt-2">
                <input type="number" id="rollInput" class="form-control rounded-pill text-center border-2 fs-5" placeholder="‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∞‡ßã‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßã">
            </div>
        </div>
        <button class="btn btn-success w-100 rounded-pill fw-bold py-2 mt-4 shadow" onclick="generateResult()">
            üöÄ ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶ì
        </button>
    </div>

    <div class="text-center premium-archive-section mb-5">
        <button type="button" class="premium-archive-btn" data-bs-toggle="modal" data-bs-target="#archiveModal">
            üìÖ ‡¶™‡ßÅ‡¶∞‡ßã‡¶®‡ßã ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü
        </button>
    </div>
</div>

<div class="modal fade" id="archiveModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="border-radius:25px;">
            <div class="modal-header bg-success text-white border-0">
                <h5 class="modal-title fw-bold">‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶¨‡¶∞‡ßç‡¶∑ ‡¶¨‡ßá‡¶õ‡ßá ‡¶®‡¶æ‡¶ì</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4 text-center">
                <div class="row g-3">
                    <div class="col-6"><a href="results.html?year=2026" class="btn btn-outline-success w-100 py-2 fw-bold">‡ß®‡ß¶‡ß®‡ß¨</a></div>
                    <div class="col-6"><a href="results.html?year=2025" class="btn btn-outline-success w-100 py-2 fw-bold">‡ß®‡ß¶‡ß®‡ß´</a></div>
                    <div class="col-6"><a href="results.html?year=2024" class="btn btn-outline-success w-100 py-2 fw-bold">‡ß®‡ß¶‡ß®‡ß™</a></div>
                    <div class="col-6"><a href="results.html?year=2023" class="btn btn-outline-success w-100 py-2 fw-bold">‡ß®‡ß¶‡ß®‡ß©</a></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="resultArea" class="d-none"></div>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const selectedYear = urlParams.get('year') || "2026";
    const is2026 = (selectedYear === "2026");

    function toBanglaNum(num) {
        const banglaNums = {'0':'‡ß¶','1':'‡ßß','2':'‡ß®','3':'‡ß©','4':'‡ß™','5':'‡ß´','6':'‡ß¨','7':'‡ß≠','8':'‡ßÆ','9':'‡ßØ'};
        return num.toString().split('').map(digit => banglaNums[digit] || digit).join('');
    }

    window.onload = function() {
        const titleElement = document.getElementById('searchTitle');
        titleElement.innerHTML = `üåà ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶¨‡¶ï‡ßç‡¶∏ - ${toBanglaNum(selectedYear)}`;
    };

    function generateResult() {
        const cls = document.getElementById('classSelect').value;
        const term = document.getElementById('termSelect').value;
        const roll = document.getElementById('rollInput').value;
        
        const scriptPath = is2026 ? `results/2026/${cls}/${term}.js` : `results/${selectedYear}/${cls}/final.js`;
        const oldScript = document.getElementById('data-script');
        if(oldScript) oldScript.remove();

        const script = document.createElement('script');
        script.id = 'data-script';
        script.src = scriptPath;
        script.onload = function() {
            const dataVarName = is2026 ? `data_2026_${cls}_${term}` : `final_data_${selectedYear}`;
            const currentData = window[dataVarName];
            const student = currentData ? currentData.find(s => parseInt(s.roll) === parseInt(roll)) : null;

            if(student) {
                renderSheet(student, cls, term);
                window.scrollTo({ top: document.getElementById('resultArea').offsetTop, behavior: 'smooth' });
            } else {
                alert("‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø!");
            }
        };
        document.head.appendChild(script);
    }

    function renderSheet(s, cls, term) {
        let rows = "";
        let totalPoints = 0;
        
        if(is2026) {
            s.marks.forEach(m => {
                let full = m.subject.match(/‡¶∂‡¶æ‡¶∞‡ßÄ‡¶∞‡¶ø‡¶ï|‡¶∏‡¶ô‡ßç‡¶ó‡ßÄ‡¶§|‡¶ö‡¶æ‡¶∞‡ßÅ|‡¶∂‡¶ø‡¶≤‡ßç‡¶™/) ? 50 : 100;
                let gp = calculateGP(m.obtained, full);
                totalPoints += gp.point;
                rows += `<tr><td>${m.subject}</td><td>${toBanglaNum(full)}</td><td>${toBanglaNum(m.obtained)}</td><td>${gp.letter}</td><td>${toBanglaNum(gp.point.toFixed(2))}</td></tr>`;
            });
        } else {
            s.subjects.forEach(sub => {
                let full = sub.name.match(/‡¶∂‡¶æ‡¶∞‡ßÄ‡¶∞‡¶ø‡¶ï|‡¶∏‡¶ô‡ßç‡¶ó‡ßÄ‡¶§|‡¶ö‡¶æ‡¶∞‡ßÅ|‡¶∂‡¶ø‡¶≤‡ßç‡¶™/) ? 50 : 100;
                let finalScore = (sub.t1 * 0.15) + (sub.t2 * 0.15) + (sub.t3 * 0.70);
                let gp = calculateGP(finalScore, full);
                totalPoints += gp.point;
                rows += `<tr><td>${sub.name}</td><td>${toBanglaNum(sub.t1)}</td><td>${toBanglaNum(sub.t2)}</td><td>${toBanglaNum(sub.t3)}</td><td>${toBanglaNum(finalScore.toFixed(2))}</td><td>${gp.letter}</td><td>${toBanglaNum(gp.point.toFixed(2))}</td></tr>`;
            });
        }
        
        const subjectsCount = is2026 ? s.marks.length : s.subjects.length;
        const gpa = (totalPoints / subjectsCount).toFixed(2);
        const now = new Date();
        const timestamp = now.toLocaleDateString('bn-BD') + " " + now.toLocaleTimeString('bn-BD');

        document.getElementById('resultArea').innerHTML = `
            <img src="images/dpe.png" class="watermark-img">
            <div id="printTimestamp">‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶™‡¶ø: ${timestamp}</div>
            <div class="main-content">
                <div class="text-center">
                    <img src="images/govt.png" style="width:70px" class="mb-1">
                    <h2 class="premium-title mb-0" style="color: #006A4E; font-size: 30px;">‡ßß‡ß®‡¶®‡¶Ç ‡¶ï‡¶æ‡¶≤‡¶æ‡¶á‡¶Ø‡¶º‡¶æ ‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶≤‡¶Ø‡¶º</h2>
                    <p class="mb-0 fw-bold" style="font-size: 21px;">‡¶á‡¶®‡ßç‡¶¶‡ßÅ‡¶∞‡¶ï‡¶æ‡¶®‡ßÄ (‡¶ú‡¶ø‡¶Ø‡¶º‡¶æ‡¶®‡¶ó‡¶∞), ‡¶™‡¶ø‡¶∞‡ßã‡¶ú‡¶™‡ßÅ‡¶∞ </p>
                    <p class="mb-0 fw-bold" style="font-size: 21px;">‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶ø‡¶§: ‡ßß‡ßØ‡ß©‡ß¶</p>
                    <h4 class="mt-4 border-bottom d-inline-block pb-1 fw-bold">‡¶è‡¶ï‡¶æ‡¶°‡ßá‡¶Æ‡¶ø‡¶ï ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü - ${toBanglaNum(selectedYear)}</h4>
                </div>
                <div class="row mt-4 mb-2 px-2" style="font-size:18px;">
                    <div class="col-7">
                        <p class="mb-1"><strong>‡¶®‡¶æ‡¶Æ:</strong> <span class="student-name">${s.name}</span></p>
                        <p class="mb-1"><strong>‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø:</strong> ${toBanglaNum(cls)}‡¶Æ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø</p>
                    </div>
                    <div class="col-5 text-end">
                        <p class="mb-1"><strong>‡¶∞‡ßã‡¶≤:</strong> ${toBanglaNum(s.roll)}</p>
                        <p class="mb-1"><strong>‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®:</strong> ${is2026 ? '‡¶™‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø‡¶ï' : '‡¶∏‡¶Æ‡¶®‡ßç‡¶¨‡¶ø‡¶§'}</p>
                    </div>
                </div>
                <table class="table-main table-bordered text-center table-font border-dark">
                    <thead class="table-light">
                        ${is2026 ? 
                        '<tr><th>‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</th><th>‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶Æ‡¶æ‡¶®</th><th>‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶§ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</th><th>‡¶ó‡ßç‡¶∞‡ßá‡¶°</th><th>‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü</th></tr>' :
                        '<tr><th rowspan="2">‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</th><th colspan="3">‡¶™‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø‡¶ï‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶§ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</th><th rowspan="2">‡¶Æ‡ßã‡¶ü (‡ßß‡ß¶‡ß¶%)</th><th rowspan="2">‡¶ó‡ßç‡¶∞‡ßá‡¶°</th><th rowspan="2">‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü</th></tr><tr><th>‡ßß‡¶Æ (‡ßß‡ß´%)</th><th>‡ß®‡¶Ø‡¶º (‡ßß‡ß´%)</th><th>‡ß©‡¶Ø‡¶º (‡ß≠‡ß¶%)</th></tr>'}
                    </thead>
                    <tbody class="fw-bold">${rows}</tbody>
                    <tfoot>
                        <tr class="fw-bold bg-light">
                            <td colspan="${is2026 ? 3 : 5}" class="text-end pe-4">‡¶ú‡¶ø‡¶™‡¶ø‡¶è (GPA)</td>
                            <td colspan="2" class="text-success" style="font-size: 22px;">${toBanglaNum(gpa)}</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            <div class="footer-signatures">
                <div class="text-center">.........................<br>‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï</div>
                <div class="text-center">.........................<br>‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï</div>
            </div>
            <div class="mt-4 text-center no-print" style="position:relative; z-index:1001;">
                <button class="btn btn-dark rounded-pill px-5 shadow-lg" onclick="window.print()">
                    <i class="fas fa-print me-2"></i> ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶∂‡¶ø‡¶ü ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
            </div>
        `;
        document.getElementById('resultArea').classList.remove('d-none');
    }

    function calculateGP(obt, full) {
        let p = (obt / full) * 100;
        if (p >= 80) return { letter: "A+", point: 5.0 };
        if (p >= 70) return { letter: "A", point: 4.0 };
        if (p >= 60) return { letter: "A-", point: 3.5 };
        if (p >= 50) return { letter: "B", point: 3.0 };
        if (p >= 40) return { letter: "C", point: 2.0 };
        if (p >= 33) return { letter: "D", point: 1.0 };
        return { letter: "F", point: 0.0 };
    }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
