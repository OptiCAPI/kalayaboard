<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>একাডেমিক ট্রান্সক্রিপ্ট | কালাইয়া বোর্ড সপ্রাবি</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Mobile & Screen Styling */
        #resultArea {
            max-width: 800px;
            background: white;
            position: relative;
            border: 4px double #006A4E;
            padding: 30px;
            margin-top: 20px;
            z-index: 1;
        }

        .watermark-img {
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            opacity: 0.12; /* Optimized for printing */
            z-index: 0;
            pointer-events: none;
        }

        .content-wrap { position: relative; z-index: 1; }
        .gov-logo { width: 60px; height: auto; margin-bottom: 10px; }

        .signature-box {
            margin-top: 50px;
            border-top: 1px dashed #333;
            padding-top: 5px;
            width: 180px;
            font-size: 0.85rem;
            text-align: center;
        }

        /* --- PROFESSIONAL PRINT SETTINGS --- */
        @media print {
            .navbar, .search-form-card, .btn-print-action, .ticker-wrap, .btn-call { 
                display: none !important; 
            }
            body { background: white !important; margin: 0; padding: 0; }
            #resultArea { 
                display: block !important;
                border: 4px double #006A4E !important; 
                box-shadow: none !important; 
                width: 100% !important;
                margin: 0 !important;
                padding: 40px !important; 
            }
            @page { size: A4; margin: 1in; }
            .watermark-img { -webkit-print-color-adjust: exact; opacity: 0.15 !important; }
        }
    </style>
</head>
<body class="bg-light">

    <nav class="navbar navbar-dark bg-green shadow-sm mb-4">
        <div class="container d-flex justify-content-between">
            <a href="index.html" class="btn btn-light btn-sm rounded-pill"><i class="fas fa-arrow-left"></i> হোম</a>
            <span class="navbar-brand fw-bold">ফলাফল অনুসন্ধান</span>
            <div style="width: 45px;"></div> 
        </div>
    </nav>

    <div class="container mt-4 mb-5">
        <div class="card p-4 shadow-sm mx-auto search-form-card mb-5" style="max-width: 500px; border-radius: 20px; border: none;">
            <h5 class="text-center fw-bold text-success mb-3">শিক্ষার্থীর তথ্য দিন</h5>
            <div class="mb-3">
                <label class="form-label small fw-bold">রোল নম্বর</label>
                <input type="number" class="form-control rounded-pill" id="rollInput" placeholder="উদা: ০৫">
            </div>
            <div class="mb-3">
                <label class="form-label small fw-bold">শ্রেণি</label>
                <select class="form-select rounded-pill" id="classSelect">
                    <option>১ম শ্রেণি</option><option>২য় শ্রেণি</option><option>৩য় শ্রেণি</option><option>৪র্থ শ্রেণি</option><option>৫ম শ্রেণি</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="form-label small fw-bold">মূল্যায়ন</label>
                <select class="form-select rounded-pill" id="termSelect">
                    <option>১ম প্রান্তিক মূল্যায়ন</option><option selected>২য় প্রান্তিক মূল্যায়ন</option><option>৩য় প্রান্তিক মূল্যায়ন</option>
                </select>
            </div>
            <button class="btn btn-success w-100 rounded-pill fw-bold" onclick="generateResult()">ফলাফল দেখুন</button>
        </div>

        <div id="resultArea" class="mx-auto d-none shadow-lg">
            <img src="images/dpe.png" class="watermark-img" alt="Watermark">
            <div class="content-wrap">
                <div class="text-center mb-4">
                    <img src="images/govt.png" class="gov-logo" alt="Govt Logo">
                    <h3 class="fw-bold mb-0" style="color: #006A4E;">কালাইয়া বোর্ড সরকারি প্রাথমিক বিদ্যালয়</h3>
                    <p class="small mb-0">উপজেলা: ইন্দুরকানী (জিয়ানগর), জেলা: পিরোজপুর</p>
                    <h5 class="mt-3 fw-bold border-bottom d-inline-block pb-1">একাডেমিক ট্রান্সক্রিপ্ট</h5>
                </div>

                <div class="row mb-4 mt-4 small">
                    <div class="col-7">
                        <p class="mb-1"><strong>শিক্ষার্থীর নাম:</strong> <span id="outName">-</span></p>
                        <p class="mb-1"><strong>শ্রেণি:</strong> <span id="outClass">-</span></p>
                    </div>
                    <div class="col-5 text-end">
                        <p class="mb-1"><strong>রোল নং:</strong> <span id="outRoll">-</span></p>
                        <p class="mb-1"><strong>পরীক্ষা:</strong> <span id="outTerm">-</span></p>
                    </div>
                </div>

                <table class="table table-bordered border-dark text-center align-middle small">
                    <thead class="table-light">
                        <tr>
                            <th>বিষয়</th>
                            <th>পূর্ণমান</th>
                            <th>প্রাপ্ত নম্বর</th>
                            <th>গ্রেড</th>
                            <th>গ্রেড পয়েন্ট</th>
                        </tr>
                    </thead>
                    <tbody id="marksTableBody"></tbody>
                </table>

                <div class="row mt-4">
                    <div class="col-12">
                        <div class="p-2 border bg-light text-center fw-bold">
                            মোট জিপিএ (GPA): <span id="finalGPA" class="text-success">০.০০</span> | ফলাফল: <span id="status">উত্তীর্ণ</span>
                        </div>
                    </div>
                </div>

                <div class="d-flex justify-content-between mt-5 pt-4">
    <div class="signature-box position-relative">
        <img src="images/signature_teacher.png" alt="Signature" style="position: absolute; top: -45px; left: 50%; transform: translateX(-50%); width: 100px; height: auto;">
        শ্রেণি শিক্ষকের স্বাক্ষর
    </div>
    <div class="signature-box position-relative">
        <img src="images/signature_head.png" alt="Signature" style="position: absolute; top: -45px; left: 50%; transform: translateX(-50%); width: 100px; height: auto;">
        প্রধান শিক্ষকের স্বাক্ষর
    </div>
</div>

                <div class="mt-5 text-center btn-print-action">
                    <button class="btn btn-dark rounded-pill px-4" onclick="window.print()">
                        <i class="fas fa-print me-2"></i> ট্রান্সক্রিপ্ট প্রিন্ট করুন
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="data_2025_class5.js"></script>

    <script>
        function getGradeInfo(marks) {
            if (marks >= 80) return { letter: "A+", point: 5.0 };
            if (marks >= 70) return { letter: "A", point: 4.0 };
            if (marks >= 60) return { letter: "A-", point: 3.5 };
            if (marks >= 50) return { letter: "B", point: 3.0 };
            if (marks >= 40) return { letter: "C", point: 2.0 };
            if (marks >= 33) return { letter: "D", point: 1.0 };
            return { letter: "F", point: 0.0 };
        }

        function generateResult() {
            const rollInput = document.getElementById('rollInput').value;
            const classInput = document.getElementById('classSelect').value;
            const termInput = document.getElementById('termSelect').value;

            if(!rollInput) return alert("রোল দিন!");

            // SEARCH IN DATA.JS
            const student = studentData.find(s => 
                s.roll == rollInput && 
                s.class == classInput && 
                s.term == termInput
            );

            if(student) {
                let tableHTML = "";
                let totalPoints = 0;

                student.marks.forEach(m => {
                    const grade = getGradeInfo(m.obtained);
                    totalPoints += grade.point;
                    tableHTML += `<tr><td>${m.subject}</td><td>${m.full}</td><td>${m.obtained}</td><td>${grade.letter}</td><td>${grade.point.toFixed(2)}</td></tr>`;
                });

                document.getElementById('marksTableBody').innerHTML = tableHTML;
                document.getElementById('outName').innerText = student.name;
                document.getElementById('outRoll').innerText = student.roll;
                document.getElementById('outClass').innerText = student.class;
                document.getElementById('outTerm').innerText = student.term;

                const gpa = (totalPoints / student.marks.length).toFixed(2);
                document.getElementById('finalGPA').innerText = gpa;
                document.getElementById('status').innerText = gpa >= 1.0 ? "উত্তীর্ণ" : "অনুত্তীর্ণ";

                document.getElementById('resultArea').classList.remove('d-none');
                document.getElementById('resultArea').scrollIntoView({ behavior: 'smooth' });
            } else {
    // Show professional error message on page
    document.getElementById('resultArea').innerHTML = `
        <div class="alert alert-danger text-center shadow-sm" style="border-radius: 15px; border: 2px solid #dc3545;">
            <i class="fas fa-exclamation-circle fa-3x mb-3"></i><br>
            <h5 class="fw-bold">ফলাফল পাওয়া যায়নি!</h5>
            <p>দুঃখিত, আপনার প্রদানকৃত রোল নম্বর, শ্রেণি বা মূল্যায়নের তথ্য আমাদের ডাটাবেজে নেই।</p>
            <hr>
            <small>সঠিক তথ্য দিয়ে পুনরায় চেষ্টা করুন অথবা প্রধান শিক্ষকের সাথে যোগাযোগ করুন।</small>
        </div>`;
    document.getElementById('resultArea').classList.remove('d-none');
            }
        }
    </script>
</body>
</html>
